from camel.toolkits.medcalc_bench.adjusted_body_weight import abw_explanation
from camel.toolkits.medcalc_bench.adjusted_body_weight import round_number
from camel.toolkits.medcalc_bench.adjusted_body_weight import weight_conversion_explanation
from camel.toolkits.medcalc_bench.albumin_corrected_anion import compute_albumin_corrected_anion_explanation
from camel.toolkits.medcalc_bench.albumin_corrected_anion import conversion_explanation
from camel.toolkits.medcalc_bench.albumin_corrected_anion import round_number
from camel.toolkits.medcalc_bench.albumin_corrected_delta_gap import compute_albumin_corrected_anion_explanation
from camel.toolkits.medcalc_bench.albumin_corrected_delta_gap import compute_albumin_corrected_delta_gap_explanation
from camel.toolkits.medcalc_bench.albumin_corrected_delta_gap import round_number
from camel.toolkits.medcalc_bench.albumin_delta_ratio import compute_albumin_corrected_delta_gap_explanation
from camel.toolkits.medcalc_bench.albumin_delta_ratio import compute_albumin_delta_ratio_explanation
from camel.toolkits.medcalc_bench.albumin_delta_ratio import conversion_explanation
from camel.toolkits.medcalc_bench.albumin_delta_ratio import round_number
from camel.toolkits.medcalc_bench.anion_gap import compute_anion_gap_explanation
from camel.toolkits.medcalc_bench.anion_gap import conversion_explanation
from camel.toolkits.medcalc_bench.anion_gap import round_number
from camel.toolkits.medcalc_bench.apache_ii import age_conversion_explanation
from camel.toolkits.medcalc_bench.apache_ii import apache_ii_explanation
from camel.toolkits.medcalc_bench.apache_ii import conversion_explanation
from camel.toolkits.medcalc_bench.apache_ii import convert_to_units_per_liter_explanation
from camel.toolkits.medcalc_bench.apache_ii import fahrenheit_to_celsius_explanation
from camel.toolkits.medcalc_bench.apache_ii import mean_arterial_pressure_explanation
from camel.toolkits.medcalc_bench.bmi_calculator import bmi_calculator_explanation
from camel.toolkits.medcalc_bench.bmi_calculator import height_conversion_explanation
from camel.toolkits.medcalc_bench.bmi_calculator import round_number
from camel.toolkits.medcalc_bench.bmi_calculator import weight_conversion_explanation
from camel.toolkits.medcalc_bench.bsa_calculator import bsa_calculator_explaination
from camel.toolkits.medcalc_bench.bsa_calculator import height_conversion_explanation_cm
from camel.toolkits.medcalc_bench.bsa_calculator import round_number
from camel.toolkits.medcalc_bench.bsa_calculator import weight_conversion_explanation
from camel.toolkits.medcalc_bench.calcium_correction import calculate_corrected_calcium_explanation
from camel.toolkits.medcalc_bench.calcium_correction import conversion_explanation
from camel.toolkits.medcalc_bench.calcium_correction import round_number
from camel.toolkits.medcalc_bench.caprini_score import age_conversion_explanation
from camel.toolkits.medcalc_bench.caprini_score import caprini_score_explanation
from camel.toolkits.medcalc_bench.cardiac_risk_index import compute_cardiac_index_explanation
from camel.toolkits.medcalc_bench.cardiac_risk_index import conversion_explanation
from camel.toolkits.medcalc_bench.cci import age_conversion_explanation
from camel.toolkits.medcalc_bench.cci import compute_cci_explanation
from camel.toolkits.medcalc_bench.centor_score import age_conversion_explanation
from camel.toolkits.medcalc_bench.centor_score import compute_centor_score_explanation
from camel.toolkits.medcalc_bench.centor_score import fahrenheit_to_celsius_explanation
from camel.toolkits.medcalc_bench.cha2ds2_vasc_score import age_conversion_explanation
from camel.toolkits.medcalc_bench.cha2ds2_vasc_score import generate_cha2ds2_vasc_explanation
from camel.toolkits.medcalc_bench.child_pugh_score import compute_child_pugh_score_explanation
from camel.toolkits.medcalc_bench.child_pugh_score import conversion_explanation
from camel.toolkits.medcalc_bench.ckd_epi_2021_creatinine import age_conversion
from camel.toolkits.medcalc_bench.ckd_epi_2021_creatinine import age_conversion_explanation
from camel.toolkits.medcalc_bench.ckd_epi_2021_creatinine import ckd_epi_2021
from camel.toolkits.medcalc_bench.ckd_epi_2021_creatinine import ckd_epi_2021_explanation
from camel.toolkits.medcalc_bench.ckd_epi_2021_creatinine import conversion_explanation
from camel.toolkits.medcalc_bench.ckd_epi_2021_creatinine import round_number
from camel.toolkits.medcalc_bench.compute_fena import compute_fena_explanation
from camel.toolkits.medcalc_bench.compute_fena import conversion_explanation
from camel.toolkits.medcalc_bench.compute_fena import round_number
from camel.toolkits.medcalc_bench.conception_date import add_2_weeks_explanation
from camel.toolkits.medcalc_bench.creatinine_clearance import age_conversion_explanation
from camel.toolkits.medcalc_bench.creatinine_clearance import conversion_explanation
from camel.toolkits.medcalc_bench.creatinine_clearance import generate_cockcroft_gault_explanation
from camel.toolkits.medcalc_bench.creatinine_clearance import round_number
from camel.toolkits.medcalc_bench.creatinine_clearance import weight_conversion_explanation
from camel.toolkits.medcalc_bench.curb_65 import age_conversion_explanation
from camel.toolkits.medcalc_bench.curb_65 import conversion_explanation
from camel.toolkits.medcalc_bench.curb_65 import curb_65_explanation
from camel.toolkits.medcalc_bench.delta_gap import compute_anion_gap_explanation
from camel.toolkits.medcalc_bench.delta_gap import compute_delta_gap_explanation
from camel.toolkits.medcalc_bench.delta_gap import round_number
from camel.toolkits.medcalc_bench.estimated_due_date import add_40_weeks_explanation
from camel.toolkits.medcalc_bench.feverpain import compute_fever_pain_explanation
from camel.toolkits.medcalc_bench.fibrosis_4 import age_conversion_explanation
from camel.toolkits.medcalc_bench.fibrosis_4 import compute_fib4_explanation
from camel.toolkits.medcalc_bench.fibrosis_4 import convert_to_units_per_liter_explanation
from camel.toolkits.medcalc_bench.fibrosis_4 import round_number
from camel.toolkits.medcalc_bench.framingham_risk_score import age_conversion_explanation
from camel.toolkits.medcalc_bench.framingham_risk_score import conversion_explanation
from camel.toolkits.medcalc_bench.framingham_risk_score import framingham_risk_score_explanation
from camel.toolkits.medcalc_bench.free_water_deficit import age_conversion_explanation
from camel.toolkits.medcalc_bench.free_water_deficit import conversion_explanation
from camel.toolkits.medcalc_bench.free_water_deficit import free_water_deficit_explanation
from camel.toolkits.medcalc_bench.free_water_deficit import round_number
from camel.toolkits.medcalc_bench.free_water_deficit import weight_conversion_explanation
from camel.toolkits.medcalc_bench.gestational_age import compute_gestational_age_explanation
from camel.toolkits.medcalc_bench.glasgow_bleeding_score import conversion_explanation
from camel.toolkits.medcalc_bench.glasgow_bleeding_score import glasgow_bleeding_score_explanation
from camel.toolkits.medcalc_bench.glasgow_coma_score import compute_glasgow_coma_score_explanation
from camel.toolkits.medcalc_bench.has_bled_score import age_conversion_explanation
from camel.toolkits.medcalc_bench.has_bled_score import compute_has_bled_score_explanation
from camel.toolkits.medcalc_bench.heart_score import age_conversion_explanation
from camel.toolkits.medcalc_bench.heart_score import compute_heart_score_explanation
from camel.toolkits.medcalc_bench.homa_ir import compute_homa_ir_explanation
from camel.toolkits.medcalc_bench.homa_ir import conversion_explanation
from camel.toolkits.medcalc_bench.homa_ir import round_number
from camel.toolkits.medcalc_bench.ideal_body_weight import height_conversion_explanation_in
from camel.toolkits.medcalc_bench.ideal_body_weight import ibw_explanation
from camel.toolkits.medcalc_bench.ideal_body_weight import round_number
from camel.toolkits.medcalc_bench.ldl_calculated import compute_ldl_explanation
from camel.toolkits.medcalc_bench.ldl_calculated import conversion_explanation
from camel.toolkits.medcalc_bench.ldl_calculated import round_number
from camel.toolkits.medcalc_bench.maintenance_fluid_calc import maintenance_fluid_explanation
from camel.toolkits.medcalc_bench.maintenance_fluid_calc import round_number
from camel.toolkits.medcalc_bench.maintenance_fluid_calc import weight_conversion_explanation
from camel.toolkits.medcalc_bench.mdrd_gfr import age_conversion_explanation
from camel.toolkits.medcalc_bench.mdrd_gfr import conversion_explanation
from camel.toolkits.medcalc_bench.mdrd_gfr import mrdr_gfr_explanation
from camel.toolkits.medcalc_bench.mdrd_gfr import round_number
from camel.toolkits.medcalc_bench.mean_arterial_pressure import mean_arterial_pressure_explanation
from camel.toolkits.medcalc_bench.mean_arterial_pressure import round_number
from camel.toolkits.medcalc_bench.meldna import compute_meldna_explanation
from camel.toolkits.medcalc_bench.meldna import conversion_explanation
from camel.toolkits.medcalc_bench.mme import conversion_explanation
from camel.toolkits.medcalc_bench.mme import mme_explanation
from camel.toolkits.medcalc_bench.mme import round_number
from camel.toolkits.medcalc_bench.perc_rule import age_conversion_explanation
from camel.toolkits.medcalc_bench.perc_rule import compute_perc_rule_explanation
from camel.toolkits.medcalc_bench.psi_score import age_conversion_explanation
from camel.toolkits.medcalc_bench.psi_score import conversion_explanation
from camel.toolkits.medcalc_bench.psi_score import fahrenheit_to_celsius_explanation
from camel.toolkits.medcalc_bench.psi_score import psi_score_explanation
from camel.toolkits.medcalc_bench.qt_calculator_bazett import bazett_calculator_explanation
from camel.toolkits.medcalc_bench.qt_calculator_bazett import round_number
from camel.toolkits.medcalc_bench.qt_calculator_framingham import framingham_calculator_explanation
from camel.toolkits.medcalc_bench.qt_calculator_framingham import round_number
from camel.toolkits.medcalc_bench.qt_calculator_fredericia import fredericia_calculator_explanation
from camel.toolkits.medcalc_bench.qt_calculator_fredericia import round_number
from camel.toolkits.medcalc_bench.qt_calculator_hodges import hodges_calculator_explanation
from camel.toolkits.medcalc_bench.qt_calculator_hodges import round_number
from camel.toolkits.medcalc_bench.qt_calculator_rautaharju import rautaharju_calculator_explanation
from camel.toolkits.medcalc_bench.qt_calculator_rautaharju import round_number
from camel.toolkits.medcalc_bench.sOsm import compute_serum_osmolality_explanation
from camel.toolkits.medcalc_bench.sOsm import conversion_explanation
from camel.toolkits.medcalc_bench.sOsm import round_number
from camel.toolkits.medcalc_bench.sch import compute_sodium_correction_hyperglycemia_explanation
from camel.toolkits.medcalc_bench.sch import conversion_explanation
from camel.toolkits.medcalc_bench.sch import round_number
from camel.toolkits.medcalc_bench.sirs_criteria import convert_to_units_per_liter_explanation
from camel.toolkits.medcalc_bench.sirs_criteria import fahrenheit_to_celsius_explanation
from camel.toolkits.medcalc_bench.sirs_criteria import sirs_criteria_explanation
from camel.toolkits.medcalc_bench.sofa import compute_sofa_explanation
from camel.toolkits.medcalc_bench.sofa import conversion_explanation
from camel.toolkits.medcalc_bench.sofa import convert_to_units_per_liter_explanation
from camel.toolkits.medcalc_bench.sofa import round_number
from camel.toolkits.medcalc_bench.steroid_conversion import compute_steroid_conversion_explanation
from camel.toolkits.medcalc_bench.steroid_conversion import conversion_explanation
from camel.toolkits.medcalc_bench.steroid_conversion import round_number
from camel.toolkits.medcalc_bench.target_weight import height_conversion_explanation
from camel.toolkits.medcalc_bench.target_weight import round_number
from camel.toolkits.medcalc_bench.target_weight import targetweight_explanation
from camel.toolkits.medcalc_bench.wells_criteria_dvt import compute_wells_criteria_dvt_explanation
from camel.toolkits.medcalc_bench.wells_criteria_pe import calculate_pe_wells_explanation
from camel.toolkits.medcalc_bench.steroid_conversion import compute_steroid_conversion_explanation
from camel.toolkits.medcalc_bench.estimated_due_date import add_40_weeks_explanation

result=abw_explanation( {
            "weight": (150, "lbs"),  # weight 150 lbs
            "height": (170, "cm"),  # height 170 cm
            "sex": "Male",  # Male
        })


print(result)

# Add this function at the end of the file to handle dictionary input for BMI calculation
def bmi_calculator_with_dict(input_dict):
    """
    Calculate BMI from a dictionary input
    
    Args:
        input_dict: Dictionary containing weight and height information
        
    Returns:
        float: BMI value
    """
    if 'weight' in input_dict and 'height' in input_dict:
        # If weight and height are already tuples in the dictionary
        weight = input_dict['weight']
        height = input_dict['height']
        
        # Handle if they're tuples with units
        if isinstance(weight, tuple) and len(weight) == 2:
            weight_value = weight[0]
            weight_unit = weight[1]
        else:
            weight_value = weight
            weight_unit = 'kg'
            
        if isinstance(height, tuple) and len(height) == 2:
            height_value = height[0]
            height_unit = height[1]
        else:
            height_value = height
            height_unit = 'cm'
            
        # Convert to standard units if needed
        if weight_unit != 'kg':
            # Convert weight to kg
            if weight_unit == 'lbs':
                weight_value = weight_value * 0.453592
        
        if height_unit != 'm':
            # Convert height to meters
            if height_unit == 'cm':
                height_value = height_value / 100
            elif height_unit == 'in':
                height_value = height_value * 0.0254
        
        # Calculate BMI
        bmi = weight_value / (height_value ** 2)
        return bmi
    
    # If weight and height are specified separately with value/unit keys
    elif 'weight_value' in input_dict and 'height_value' in input_dict:
        weight_value = input_dict['weight_value']
        height_value = input_dict['height_value']
        
        weight_unit = input_dict.get('weight_unit', 'kg')
        height_unit = input_dict.get('height_unit', 'cm')
        
        # Convert to standard units if needed
        if weight_unit != 'kg':
            # Convert weight to kg
            if weight_unit == 'lbs':
                weight_value = weight_value * 0.453592
        
        if height_unit != 'm':
            # Convert height to meters
            if height_unit == 'cm':
                height_value = height_value / 100
            elif height_unit == 'in':
                height_value = height_value * 0.0254
        
        # Calculate BMI
        bmi = weight_value / (height_value ** 2)
        return bmi
    
    return None

# Override the original bmi_calculator_explanation function to handle dict or individual values
def bmi_calculator_explanation(input_variables):
    # First, check if input is a dictionary
    if isinstance(input_variables, dict):
        # Try to extract weight and height from the dict
        if ('weight' in input_variables and 'height' in input_variables) or \
           ('weight_value' in input_variables and 'height_value' in input_variables):
            bmi = bmi_calculator_with_dict(input_variables)
            if bmi:
                return f"BMI = {bmi:.2f} kg/m²"
        
    # If dict didn't have expected keys or calculation failed, handle explicit parameters
    if hasattr(input_variables, 'get'):
        weight = input_variables.get('weight', None)
        height = input_variables.get('height', None)
        
        if not weight and 'weight_value' in input_variables:
            weight_value = input_variables.get('weight_value')
            weight_unit = input_variables.get('weight_unit', 'kg')
            weight = (weight_value, weight_unit)
            
        if not height and 'height_value' in input_variables:
            height_value = input_variables.get('height_value')
            height_unit = input_variables.get('height_unit', 'cm')
            height = (height_value, height_unit)
            
        if weight and height:
            # Process the values
            if isinstance(weight, tuple) and len(weight) == 2:
                weight_value, weight_unit = weight
            else:
                weight_value = weight
                weight_unit = 'kg'
                
            if isinstance(height, tuple) and len(height) == 2:
                height_value, height_unit = height
            else:
                height_value = height
                height_unit = 'cm'
            
            # Convert units if needed
            if weight_unit == 'lbs':
                weight_value = weight_value * 0.453592  # Convert to kg
                
            if height_unit == 'cm':
                height_value = height_value / 100  # Convert to meters
            elif height_unit == 'in':
                height_value = height_value * 0.0254  # Convert to meters
                
            # Calculate BMI
            bmi = weight_value / (height_value ** 2)
            return f"BMI = {bmi:.2f} kg/m²"
    
    # Default response if calculation couldn't be performed
    return "Insufficient data to calculate BMI. Please provide weight and height."